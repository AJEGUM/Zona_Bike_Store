<div class="min-h-screen bg-[#111827] flex justify-center items-center px-4 py-12">

  <div class="max-w-6xl w-full grid grid-cols-1 md:grid-cols-2 gap-8">

    <!-- RESUMEN DEL PEDIDO -->
    <div class="bg-white p-8 rounded-2xl shadow-xl">

      <h2 class="text-lg font-semibold mb-6 text-gray-900">Resumen del Pedido</h2>

      <div *ngFor="let p of productos" class="flex justify-between mb-4">
        <div>
          <p class="font-medium text-gray-900">{{ p.cantidad }}× {{ p.nombre }}</p>
          <p class="text-xs text-gray-500">
            ${{ (p.cantidad * p.precio_unitario) | number:'1.0-0' }} COP
          </p>
        </div>
        <span class="font-semibold text-gray-700">
          {{ (p.cantidad * p.precio_unitario) | currency:'COP':'' }}
        </span>
      </div>

      <hr class="my-4">

      <div class="flex justify-between text-gray-700">
        <span>Subtotal</span>
        <span>{{ total | currency:'COP':'' }}</span>
      </div>

      <div class="flex justify-between text-xl font-semibold mt-5 text-gray-900">
        <span>Total</span>
        <span>{{ total | currency:'COP':'' }}</span>
      </div>

    </div>

    <!-- INFORMACIÓN DE PAGO -->
    <div class="bg-[#1f2537] p-8 rounded-2xl shadow-xl text-white">

      <h2 class="flex items-center gap-2 text-lg font-semibold mb-4">
        Información de Pago
      </h2>

      <hr class="mb-4">

      <div [formGroup]="formPago" class="space-y-6">

        <!-- Número de Tarjeta -->
        <div>
          <label class="text-sm text-gray-300 mb-1 block">Número de Tarjeta</label>
          <input type="text" maxlength="16" placeholder="1234 5678 9012 3456"
            formControlName="numero_tarjeta"
            (keypress)="soloNumeros($event)"
            class="w-full p-4 rounded-2xl bg-[#252b3d] text-gray-200 placeholder-gray-400 outline-none border border-transparent focus:border-indigo-400 transition">
          <p *ngIf="formPago.get('numero_tarjeta')?.touched && formPago.get('numero_tarjeta')?.invalid" class="text-red-400 text-xs mt-1">
            Número de tarjeta inválido. Debe tener 16 dígitos.
          </p>
        </div>

        <!-- Fecha de Expiración -->
        <div>
          <label class="text-sm text-gray-300 mb-1 block">Fecha de Expiración</label>
          <input type="text" maxlength="5" placeholder="MM/AA"
            formControlName="fecha_expiracion"
            (input)="autoFormatoFechaExpiracion($event)"
            class="w-full p-4 rounded-2xl bg-[#252b3d] text-gray-200 placeholder-gray-400 outline-none border border-transparent focus:border-indigo-400 transition">
          <p *ngIf="formPago.get('fecha_expiracion')?.touched && formPago.get('fecha_expiracion')?.invalid" class="text-red-400 text-xs mt-1">
            Fecha inválida. Formato MM/AA.
          </p>
        </div>

        <!-- CVV -->
        <div>
          <label class="text-sm text-gray-300 mb-1 block">CVV</label>
          <input type="text" maxlength="4" placeholder="123"
            formControlName="cvv"
            (keypress)="soloNumeros($event)"
            class="w-full p-4 rounded-2xl bg-[#252b3d] text-gray-200 placeholder-gray-400 outline-none border border-transparent focus:border-indigo-400 transition">
          <p *ngIf="formPago.get('cvv')?.touched && formPago.get('cvv')?.invalid" class="text-red-400 text-xs mt-1">
            CVV inválido. Debe tener 3 o 4 dígitos.
          </p>
        </div>

        <!-- Ciudad -->
        <div>
          <label class="text-sm text-gray-300 mb-1 block">Ciudad</label>
          <input type="text"
            formControlName="ciudad"
            (keypress)="soloLetras($event)"
            class="w-full p-4 rounded-2xl bg-[#252b3d] text-gray-200 placeholder-gray-400 outline-none border border-transparent focus:border-indigo-400 transition">
          <p *ngIf="formPago.get('ciudad')?.touched && formPago.get('ciudad')?.invalid" class="text-red-400 text-xs mt-1">
            Ciudad inválida. Solo letras y espacios.
          </p>
        </div>

        <!-- País -->
        <div>
          <label class="text-sm text-gray-300 mb-1 block">País</label>
          <input type="text"
            formControlName="pais"
            (keypress)="soloLetras($event)"
            class="w-full p-4 rounded-2xl bg-[#252b3d] text-gray-200 placeholder-gray-400 outline-none border border-transparent focus:border-indigo-400 transition">
          <p *ngIf="formPago.get('pais')?.touched && formPago.get('pais')?.invalid" class="text-red-400 text-xs mt-1">
            País inválido. Solo letras y espacios.
          </p>
        </div>

      </div>

      <!-- BOTÓN PAGAR -->
      <button 
        (click)="pagar()"
        [disabled]="cargando"
        class="w-full mt-6 bg-[#4f46e5] hover:bg-[#4338ca] disabled:opacity-50 disabled:cursor-not-allowed text-white font-semibold p-4 rounded-xl transition flex items-center justify-center gap-2">

        <svg *ngIf="cargando" class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor"
            d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z">
          </path>
        </svg>

        <span>
          {{ cargando ? 'Procesando...' : ('Pagar $' + (total | number:'1.0-0') + ' COP') }}
        </span>
      </button>

      <!-- BOTÓN REGRESAR -->
      <button (click)="regresar()"
        class="flex items-center gap-2 mt-4 mb-6 text-sm font-medium bg-white/10 hover:bg-white/20 text-gray-200 px-4 py-2 rounded-xl transition-all backdrop-blur-sm border border-white/10">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
        </svg>
        Regresar
      </button>

      <div class="text-center text-xs mt-3 opacity-70 flex justify-center items-center gap-1">
        <span class="material-icons text-yellow-400 text-base">lock</span>
        Pago seguro y encriptado
      </div>

    </div>    
  </div>
</div>
